# kkh - Kana to Kanji wo Henkan. (Enhance)

> **Note:** プロトタイプ
>
> 変換辞書を双方向ではなく一方向で運用する実験。
> 相互変換ができるようにしていると縛りがある。これを相方(ペア)を気にしなくても良くなれば、自由度が高くなりそう。
> - "dic-to-trad-kana.js": 仮名遣い辞書で新仮名から旧仮名へ変換するもの(踊り抜き)
> - "dic-to-modern-kana.js": 仮名遣い辞書で旧仮名から新仮名へ変換するもの(踊り抜き)
> - "dic-to-old-kanji.js": 漢字辞書で新字体から旧字体へ変換するもの(踊り抜き)
> - "dic-to-new-kanji.js": 漢字辞書で旧字体から新字体へ変換するもの(踊り抜き)
> - "dic-to-trad-kana-odori.js": 仮名遣い辞書で新仮名から旧仮名へ変換するもの(踊りのみ)
> - "dic-to-modern-kana-odori.js": 仮名遣い辞書で旧仮名から新仮名へ変換するもの(踊りのみ)
> - "dic-to-old-kanji-odori.js": 漢字辞書で新字体から旧字体へ変換するもの(踊りのみ)
> - "dic-to-new-kanji-odori.js": 漢字辞書で旧字体から新字体へ変換するもの(踊りのみ)
>
> 現在は踊り字のみを出力しているが、名前を "-odori" から "-enhance" に変更した。これは将来、他の拡張部分をまとめてこちらに出力する(かもしれない)から。
>
> 最新の環境で最大限のグリフ対応フォントを使用するものと仮定して運用する。例えば、次のものが挙げられる。
> - `replaceAll` 関数をサポートしているブラウザ
> - 原ノ味フォント、源ノフォント
>
> 現状ではほぼ全てのブラウザでサポートしているので、`replaceAll` については問題ない。フォントについては "font-family" で指定するかどうかは悩む。見た目は個人の信条部分だし。
>
> 異体字セレクタも活用していくので、IVS 削除機能は無くす。ファイル出力(ダウンロード)はおいおいに。
>
> 「仮名遣いのみ変換」「漢字のみ変換」は使われているのだろうか？スマホ向けのページと同じように一括変換のみにしてしまうとか？
>
> 原本辞書は 2 つのままで、ツールによる出力で 4 つの変換辞書で運用するのか、原本辞書も 4 つにしてしまうのかは、実験しているうちに方向性が出てくると思われる。当座はスクリプトを改修して先の運用でやってみる。出力辞書は 8 つになってしまった。
>
> 原本辞書はそのままの方が良さそう。分けると「編集するのどれだっけ？」となってしまう。また、漢字辞書は 2 つに分けなくても大丈夫そう？
>
> 誤変換するのでコメントアウトしてある語句、"-j2", "-t2" オプションで利用することにした。これで先頭に上げた辞書が出力される。kana-jisyo のみに効果が出る。そもそも kanji-jisyo には誤変換のコメントが無い。だから 2 つに分ける必要もないのだが、将来出てくるかもしれないし、ついでなので。
>
> 踊り字とかどうする？jisyotool でやるのは分岐が面倒なので、いっそ sed, awk で一時ファイルに出力して、それを jisyotool で変換する方が簡単かもしれない。そもそもファイル名とか内包している時点で悪いプログラムだわ。シンプルなものを組み合せる！
> - 踊り字を抜いた かな辞書(新から旧、旧から新)
> - 踊り字のみの かな辞書(新から旧、旧から新)
> - 踊り字を抜いた漢字(新から旧、旧から新)
> - 踊り字のみの漢字(新から旧、旧から新)
> 上記の 8 辞書になった。
>
> 現在は「踊り字」のみだが、「外来語」「合略仮名」「ヤ行エ」なども enhance 辞書に分ける(かも)。合意が必要。

---

### 拡張変換とは？
kkh が機能を強化して帰ってきました！

同の字点(々)、一の字点(ゝゞヽヾ)、二の字点(〻)、くの字点(〱〲〳〴〵) や異体字セレクタを利用したグリフの漢字についても変換することができるようになりました(予定のものもある)。

これらは基本版で変換した後で、各人の好みで拡張変換を選択することができます。「そこまで必要ないよ〜」という人にも、「もっともっと〜」という人にも使ってもらえると思います。

### 使い方

> Note: 変換の対象となるのは、常に「変換前の文章」のテキストエリアにある文字列になります。各種変換ボタンを押すと、変換されたテキストが「変換後の文章」のテキストエリアに表示されます。続けて別の変換をする場合は、「結果を入力へ」ボタンを押して「変換後の文章」を「変換前の文章」へ移動させてください。

次のような変換ボタンがあります。「変換前の文章」にある文字列は押したボタンの内容に則してして変換され、「変換後の文章」に表示されます。

- 基本変換
  - 一括変換: 旧文章→新文章、新文章→旧文章
  - かな変換: 旧かな→新かな、新かな→旧かな
  - 漢字変換: 旧字体→新字体、新字体→旧字体

- 拡張変換
  - 拡張変換: 旧かな→新かな、新かな→旧かな
  - 拡張変換: 旧字体→新字体、新字体→旧字体

拡張変換をする際、例えば「新文章」を「踊り字を使う旧文章」に変換させたい場合は、先に拡張変換の「新かな→旧かな」で変換しておきます。結果を入力側へ移動してから続く変換を行ないます。

逆に「踊り字を使った旧文章」を「新文章」に変換させる場合は、先に拡張変換の「旧かな→新かな」で変換しておきます。ちょっとテクニックが必要になります。

### 技術的特徴
ありません。JSON 形式の辞書を参照して文字列を単純に置き換えていきます。複雑なアルゴリズムはなく、テキストエリアに入力されている文字列に対して、辞書の要素すべてを順番に検索＆置換していくだけです。

### 結論
辞書を自分の好きなように編集して東京弁に変換したり、植物名や国名を カタカナ⇔漢字 変換したりして遊んでください。この辞書を編集する過程でその知識が身につきます (実はそれが目的かも)。
